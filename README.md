# Enterprise API - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏

```diff
! ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
! ‚ïë                                 –ê–•–¢–£–ù–ì!                                   ‚ïë
! ‚ïë                                                                           ‚ïë
! ‚ïë  –î–∞ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–µ–π—Ä–æ—Å–µ—Ç—å, —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏        ‚ïë
! ‚ïë  –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ —Ç—ã–∫–Ω—É—Ç—å –º–µ–Ω—è –≤ –ª—é–±—É—é —Å—Ç—Ä–æ—á–∫—É –∫–æ–¥–∞ –∏ —è         ‚ïë
! ‚ïë  —Å–∫–∞–∂—É: —á—Ç–æ —ç—Ç–æ, –∑–∞—á–µ–º –∏ –ø–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫ –∏ –Ω–µ –∏–Ω–∞—á–µ. –¢–∞–∫ –∫–∞–∫ –∫–æ–¥        ‚ïë
! ‚ïë  –ø–∏—Å–∞–ª —è, –∞ –Ω–µ —Ä–æ–±–æ—Ç –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã–π –Ω–∞–ø–∏—Å–∞—Ç—å —Å–∏–º—Ñ–æ–Ω–∏—é.                      ‚ïë
! ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

Enterprise-—É—Ä–æ–≤–µ–Ω—å REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏, –∞–¥—Ä–µ—Å–∞–º–∏ –∏ –≤–∏–¥–∞–º–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≥–µ–æ–ø–æ–∏—Å–∫–∞.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üè¢ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏** - –ø–æ–ª–Ω—ã–π CRUD, –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –≤–∏–¥–∞–º –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üèóÔ∏è **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä—ã** - –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ –æ–¥–Ω–æ–º—É –∞–¥—Ä–µ—Å—É
- üìç **–ì–µ–æ–ø–æ–∏—Å–∫** - –ø–æ–∏—Å–∫ –≤ —Ä–∞–¥–∏—É—Å–µ –∏ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º –∑–∞–º—ã–∫–∞–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- üè∑Ô∏è **–ò–µ—Ä–∞—Ä—Ö–∏—è –¥–æ–º–µ–Ω–æ–≤** - –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∏–¥–æ–≤ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–¥–æ 3 —É—Ä–æ–≤–Ω–µ–π)
- üì± **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —Å set-–æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- üìö **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - Swagger UI –∏ ReDoc –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **FastAPI** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **SQLAlchemy 2.0** - ORM —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
- **Alembic** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –ë–î
- **PostgreSQL** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Pydantic** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- –ü–æ—Ä—Ç—ã 8000 –∏ 5432 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/AlexLovser/TestCase/tree/main
cd TestCase
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Ä—è–¥–æ–º —Å `docker-compose.yml`):

```env
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=enterprise_db
POSTGRES_HOST=db
POSTGRES_PORT=5432
```

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
docker-compose up -d
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
1. ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è PostgreSQL –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic
3. ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (12 –¥–æ–º–µ–Ω–æ–≤, 10 –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–æ–≤, 25 –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π)
4. ‚úÖ API —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8000

**–í–∞–∂–Ω–æ:** –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ –æ–¥–Ω–æ–º—É –∞–¥—Ä–µ—Å—É (–≤ –æ–¥–Ω–æ–º –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–µ).

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **–°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π**: http://localhost:8000/api/enterprises

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
TestCase/
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ address.py   # –ú–æ–¥–µ–ª—å –∞–¥—Ä–µ—Å–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain.py    # –ú–æ–¥–µ–ª—å –¥–æ–º–µ–Ω–∞ (–≤–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ enterprise.py # –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routers/         # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ address.py   # CRUD –¥–ª—è –∞–¥—Ä–µ—Å–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain.py    # CRUD –¥–ª—è –¥–æ–º–µ–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ enterprise.py # CRUD –∏ –ø–æ–∏—Å–∫ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/         # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ address.py   # –°—Ö–µ–º—ã –¥–ª—è –∞–¥—Ä–µ—Å–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain.py    # –°—Ö–µ–º—ã –¥–ª—è –¥–æ–º–µ–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ enterprise.py # –°—Ö–µ–º—ã –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/           # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rings.py     # EarthRing –¥–ª—è –≥–µ–æ–ø–æ–∏—Å–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.py            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ migrations/          # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îÇ   ‚îú‚îÄ‚îÄ seed_data.py         # –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ alembic.ini          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt     # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ docker-compose.yml       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îú‚îÄ‚îÄ Dockerfile              # –û–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## API Endpoints

### –ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (Enterprises)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/enterprises` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π |
| POST | `/api/enterprises` | –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ |
| PUT | `/api/enterprises/{id}` | –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è |
| PATCH | `/api/enterprises/{id}` | –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |
| GET | `/api/enterprises/search/?q={name}` | –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é |
| GET | `/api/enterprises/with_address/?q={address}` | –ü–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É |
| GET | `/api/enterprises/by_domain/{domain_id}` | –ü–æ–∏—Å–∫ –ø–æ –≤–∏–¥—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| GET | `/api/enterprises/at_address/{address_id}` | –í—Å–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –≤ –∑–¥–∞–Ω–∏–∏ |
| GET | `/api/enterprises/in_circle/?x={lat}&y={lon}&r={radius}` | –ì–µ–æ–ø–æ–∏—Å–∫ –≤ —Ä–∞–¥–∏—É—Å–µ |
| GET | `/api/enterprises/in_frame/?x1={lat1}&y1={lon1}&x2={lat2}&y2={lon2}` | –ì–µ–æ–ø–æ–∏—Å–∫ –≤ –æ–±–ª–∞—Å—Ç–∏ |

### –î–æ–º–µ–Ω—ã (Domains)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/domains` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤ |
| GET | `/api/domains/{id}` | –ü–æ–ª—É—á–∏—Ç—å –¥–æ–º–µ–Ω –ø–æ ID |
| POST | `/api/domains` | –°–æ–∑–¥–∞—Ç—å –¥–æ–º–µ–Ω |
| PUT | `/api/domains/{id}` | –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –¥–æ–º–µ–Ω–∞ |
| PATCH | `/api/domains/{id}` | –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |
| DELETE | `/api/domains/{id}` | –£–¥–∞–ª–∏—Ç—å –¥–æ–º–µ–Ω |

### –ê–¥—Ä–µ—Å–∞ (Addresses)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/addresses` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–¥—Ä–µ—Å–æ–≤ |
| GET | `/api/addresses/{id}` | –ü–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å –ø–æ ID |
| GET | `/api/addresses/{id}/enterprises` | –í—Å–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –ø–æ –∞–¥—Ä–µ—Å—É |
| POST | `/api/addresses` | –°–æ–∑–¥–∞—Ç—å –∞–¥—Ä–µ—Å |
| PUT | `/api/addresses/{id}` | –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∞–¥—Ä–µ—Å–∞ |
| PATCH | `/api/addresses/{id}` | –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è

```bash
curl -X POST "http://localhost:8000/api/enterprises" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–û–û–û –ü—Ä–∏–º–µ—Ä",
    "domain_id": 1,
    "address": {
      "address": "—É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
      "latitude": 55.7558,
      "longitude": 37.6173
    },
    "phones": ["+7 (495) 123-45-67", "+7 (495) 765-43-21"]
  }'
```

### –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é

```bash
curl "http://localhost:8000/api/enterprises/search/?q=–û–û–û"
```

### –ì–µ–æ–ø–æ–∏—Å–∫ –≤ —Ä–∞–¥–∏—É—Å–µ 20–∫–º

```bash
curl "http://localhost:8000/api/enterprises/in_circle/?x=55.7558&y=37.6173&r=20000"
```

### –ü–æ–∏—Å–∫ –ø–æ –≤–∏–¥—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–≤–∫–ª—é—á–∞—è –¥–æ—á–µ—Ä–Ω–∏–µ)

```bash
curl "http://localhost:8000/api/enterprises/by_domain/1?include_children=true"
```

### –í—Å–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –≤ –æ–¥–Ω–æ–º –∑–¥–∞–Ω–∏–∏

```bash
# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –ø–æ –∞–¥—Ä–µ—Å—É (–ø–æ ID –∞–¥—Ä–µ—Å–∞)
curl "http://localhost:8000/api/enterprises/at_address/1"

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Ä–æ—É—Ç–µ—Ä –∞–¥—Ä–µ—Å–æ–≤
curl "http://localhost:8000/api/addresses/1/enterprises"
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
cd server
pip install -r requirements.txt
```

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª
5. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
alembic upgrade head
```

6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```bash
uvicorn core.main:app --reload --host 0.0.0.0 --port 8000
```

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
cd server
alembic revision --autogenerate -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
alembic upgrade head
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ Docker

```bash
docker exec server_test python -m pytest
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é

```bash
docker exec server_test python -c "from server.seed_data import seed_data; seed_data()"
```

–ò–ª–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ë–î –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:

```bash
docker exec server_test python -c "
from server.core.db import SessionLocal
from server.core.models import Phone, Enterprise, Address, Domain
from server.seed_data import seed_data

db = SessionLocal()
[db.query(m).delete() for m in [Phone, Enterprise, Address, Domain]]
db.commit()
db.close()

seed_data()
"
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π, —Ä–æ—É—Ç–µ—Ä–æ–≤ –∏ —Å—Ö–µ–º
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è** - –∫–∞—Å—Ç–æ–º–Ω—ã–µ HTTP –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —á–∏—Ç–∞–µ–º—ã—Ö –æ—à–∏–±–æ–∫
- **Query builders** - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å eager loading
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** - Pydantic –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –¥–ª—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã** - magic numbers –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

### –ì–µ–æ–ø–æ–∏—Å–∫

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ `EarthRing` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏:
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –ø–ª–æ—Å–∫—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–ª–µ—Ü
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–º—ã–∫–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ 180¬∞)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–∏—Å–∫ –≤ –∫—Ä—É–≥–µ –∏ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

### –ò–µ—Ä–∞—Ä—Ö–∏—è –¥–æ–º–µ–Ω–æ–≤

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞: 3 —É—Ä–æ–≤–Ω—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª—É–±–∏–Ω—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –¥–æ—á–µ—Ä–Ω–∏–º –¥–æ–º–µ–Ω–∞–º
- –ú–µ—Ç–æ–¥ `get_all_descendants()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Ç–æ–º–∫–æ–≤

### –¢–µ–ª–µ—Ñ–æ–Ω—ã

- Set-–æ–ø–µ—Ä–∞—Ü–∏—è: –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã —É–¥–∞–ª—è—é—Ç—Å—è, –Ω–æ–≤—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–µ
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ ORM –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ –¥–ª—è API

## –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
docker-compose logs -f server
```

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É:

```bash
docker exec -it server_test bash
```

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL:

```bash
docker exec -it db_test psql -U postgres -d enterprise_db
```

## –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞

–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker-compose down
```

–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è volumes —Å –¥–∞–Ω–Ω—ã–º–∏):

```bash
docker-compose down -v
```

## Troubleshooting

### –ü–æ—Ä—Ç 8000 –∑–∞–Ω—è—Ç

–ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ `docker-compose.yml`:

```yaml
ports:
  - "8001:8000"  # –≤–Ω–µ—à–Ω–∏–π:–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è

–£–¥–∞–ª–∏—Ç–µ volume –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ:

```bash
docker-compose down -v
docker-compose up -d
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:

```bash
docker exec server_test alembic upgrade head
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ê–≤—Ç–æ—Ä

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ enterprise-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

